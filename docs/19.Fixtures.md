# Fixtures 



1. Installation Fixtures Bundles
```bash
composer require --dev orm-fixtures
```


2. Create fixtures
```bash

<?php

namespace App\DataFixtures;

use App\Entity\User;
use Doctrine\Bundle\FixturesBundle\Fixture;
use Doctrine\Persistence\ObjectManager;
use Symfony\Component\PasswordHasher\Hasher\UserPasswordHasherInterface;

class UserFixtures extends Fixture
{

    public function __construct(
        private readonly UserPasswordHasherInterface $hasher
    )
    {
    }

    public function load(ObjectManager $manager): void
    {
        $user = new User();
        $user->setRoles(['ROLE_ADMIN'])
             ->setEmail('admin@doe.fr')
             ->setUsername('admin')
             ->setIsVerified(true)
             ->setPassword($this->hasher->hashPassword($user, '1234'))
             ->setApiToken('admin_token') // just for example
        ;

        $manager->persist($user);
        $manager->flush();
    }
}

```


3. Load fixtures 
```bash 
php bin/console doctrine:fixtures:load

```


4. Make Fixtures
```bash 
php bin/console make:fixtures

 Careful, database "symfony_recipes" will be purged. Do you want to continue? (yes/no) [no]:
 > yes

   > purging database
   > loading App\DataFixtures\AppFixtures
yao@nitro-n50-620:~/Desktop/php/grafikart/symfony7$ clear
yao@nitro-n50-620:~/Desktop/php/grafikart/symfony7$ clear
yao@nitro-n50-620:~/Desktop/php/grafikart/symfony7$ php bin/console doctrine:fixtures:load

 Careful, database "symfony_recipes" will be purged. Do you want to continue? (yes/no) [no]:
 > yes

   > purging database
   > loading App\DataFixtures\AppFixtures
yao@nitro-n50-620:~/Desktop/php/grafikart/symfony7$ clear
yao@nitro-n50-620:~/Desktop/php/grafikart/symfony7$ php bin/console make:fixtures

 The class name of the fixtures to create (e.g. AppFixtures):
 > RecipeFixtures

 created: src/DataFixtures/RecipeFixtures.php

           
  Success! 
           

 Next: Open your new fixtures class and start customizing it.
 Load your fixtures by running: php bin/console doctrine:fixtures:load
 Docs: https://symfony.com/doc/current/bundles/DoctrineFixturesBundle/index.html

```


5. Faker 
- https://fakerphp.github.io
- https://github.com/jzonta/FakerRestaurant
```bash 
composer require --dev fakerphp/faker
composer require --dev jzonta/faker-restaurant


<?php

namespace App\DataFixtures;

use App\Entity\Recipe;
use DateTimeImmutable;
use Doctrine\Bundle\FixturesBundle\Fixture;
use Doctrine\Persistence\ObjectManager;
use Faker\Factory;
use FakerRestaurant\Provider\ar_SA\Restaurant;

class RecipeFixtures extends Fixture
{
    public function load(ObjectManager $manager): void
    {
        $faker = Factory::create('fr_FR');
        $faker->addProvider(new Restaurant($faker));

        for ($i = 1; $i <= 10; $i++) {
            $recipe = (new Recipe())
                      ->setTitle($faker->foodName())
                      ->setUpdatedAt(DateTimeImmutable::createFromMutable($faker->dateTime()))
                      ->setCreatedAt(DateTimeImmutable::createFromMutable($faker->dateTime()))
                      ->setContent($faker->paragraphs(10, true))
                      ->setDuration($faker->numberBetween(2, 60));
            $manager->persist($recipe);
        }

        $manager->flush();
    }
}



php bin/console doctrine:fixtures:load -n
```